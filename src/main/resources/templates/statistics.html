<!DOCTYPE html>
<html xmlns= "http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head th:include="fragments/header :: header"></head>

<body>
  <div class="container-scroller">
    <div th:include="fragments/navbar-admin :: navbar"></div>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <div th:include="fragments/sidebar-admin :: sidebar"></div>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
          	<div class="col-lg-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <div id="result-message" style="display: none; padding: 10px; font-size: 15px; border-radius: 4px; margin-bottom: 10px"></div>
                  <div class="form-group">
                  	<label for="chooseForm">Choose Form</label>
                    <select class="form-control" id="chooseForm">
                    	<option value="">-----Pick One Form-----</option>
                    	<option th:each="form : ${list}" th:value="${form.path}" th:text="${form.title}"></option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Line chart</h4>
                  <canvas id="lineChart" style="height:250px"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Bar chart</h4>
                  <canvas id="barChart" style="height:230px"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Area chart</h4>
                  <canvas id="areaChart" style="height:250px"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Doughnut chart</h4>
                  <canvas id="doughnutChart" style="height:250px"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Pie chart</h4>
                  <canvas id="pieChart" style="height:250px"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Scatter chart</h4>
                  <canvas id="scatterChart" style="height:250px"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- content-wrapper ends -->
        <div th:include="fragments/footer :: footer"></div>
        <!-- partial -->
      </div>
      <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
  </div>
  <div th:include="fragments/plugins :: plugins"></div>
  <script src="/js/chart.js"></script>
  <script th:inline="javascript">
  	/*<![CDATA[*/
  		const serverURL = 'http://localhost:8080';
  		const chooseFormSelectBox = $('#chooseForm');
  		const resultMess = $('#result-message');
  		
  		chooseFormSelectBox.change(function () {
  			const path = chooseFormSelectBox.val();
  			if (path !== "") {
  				resultMess.removeClass();
  				$.ajax({
  					url: `${serverURL}/analysis/${path}`,
  					method: 'GET',
  	  				dataType: 'json',
  	  				success: resData => {
	  	  				resultMess.addClass('alert-success');
	  					resultMess.html("Successfuly statistics!");
  	  				},
  	  				error: mess => {
  	  					resultMess.addClass('alert-danger');
  	  					resultMess.html('Could not connect to API server(' + mess.responseText + ')');
  					}
  				});
  				resultMess.show();
  			}
  		});
  	/*]]>*/
  </script>
</body>

</html>